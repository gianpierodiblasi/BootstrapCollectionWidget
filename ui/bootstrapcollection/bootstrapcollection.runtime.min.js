TW.Runtime.Widgets.bootstrapcollection=function(){function h(a,c){var m=e.getProperty(a+"Mashup"),b=e.getProperty(a+"Height"),k=e.getProperty(a+"Data");if(m&&b)switch(c){case "all":case "mashup":$(".bootstrapcollection_"+d+"_"+a).empty();$(".bootstrapcollection_"+d+"_"+a).css("height",b);$("<div class='widget-bootstrapcollection-"+a+"'></div>").css({width:"100%",height:"100%"}).appendTo(".bootstrapcollection_"+d+"_"+a).mashup({mashupName:m,mashupParameters:k&&k.rows&&k.rows[0]?k.rows[0]:void 0,loaded:function(a,
c){},loadFail:function(a){},gotSize:function(a,c){}});break;case "height":$(".bootstrapcollection_"+d+"_"+a).css("height",b)}else $(".bootstrapcollection_"+d+"_"+a).empty()}function u(a){var c=e.getProperty("data"),m=e.getProperty("debugMode");if(JSON.stringify(c)!==JSON.stringify(a)){e.setProperty("data",a);p=[];c=TW.InfoTableUtilities.CloneInfoTable({dataShape:a.dataShape,rows:a.rows.filter(function(a,c){a.mashup_selected&&p.push(c);return a.mashup_selected})});e.setProperty("selectedItems",c);
c=TW.InfoTableUtilities.CloneInfoTable({dataShape:a.dataShape,rows:[]});e.setProperty("clickedItem",c);var b=TW.InfoTableUtilities.CloneInfoTable({dataShape:{fieldDefinitions:{}},rows:[]});for(c=0;c<a.rows.length;c++)a.rows[c].mashup_data&&(b=TW.InfoTableUtilities.CloneInfoTable({dataShape:a.rows[c].mashup_data.dataShape,rows:[]}));e.setProperty("clickedDataItem",b);$(".bootstrapcollection_"+d+"_collection").empty();var k=[];b=a.rows.filter(function(a,c){a.parent_uid||k.push(c);return!a.parent_uid});
for(c=0;c<b.length;c++)r(b[c],k[c],a.rows,".bootstrapcollection_"+d+"_collection",a.dataShape,m);e.getProperty("scrollToSelected")&&(a=b.findIndex(function(a){return a.mashup_selected}),-1!==a&&(a=$(".bootstrapcollection_"+d+"_collection").children("div").eq(a).offset().top,$(".bootstrapcollection_"+d).scrollTop(a)));e.getProperty("scrollToPreviousPosition")&&n["bootstrapcollection_"+d]&&$(".bootstrapcollection_"+d).scrollTop(n["bootstrapcollection_"+d])}}function r(a,c,d,b,k,q){var f=(new Date).getTime()+
"_"+Math.floor(1E3*Math.random());q&&console.log("BootstrapCollection - addNode - rowUID = "+f);var g=$("<div class='widget-bootstrapcollection-container widget-bootstrapcollection-container-"+f+"'></div>").addClass(a.bootstrap_class).appendTo(b);if(a.is_mashup){var l=a.mashup_selection_background||a.mashup_hover_background||a.mashup_active_background?20:0;g.css("height",(a.mashup_folded_height?a.mashup_folded_height:a.height)+l+"px");a.mashup_selection_group&&g.addClass("widget-bootstrapcollection-container-selection-group-"+
a.mashup_selection_group);a.mashup_selected&&g.addClass("widget-bootstrapcollection-container-"+f+"-selected");$("<style>"+((a.mashup_selection_background?".widget-bootstrapcollection-container-"+f+"-selected {background-color: "+a.mashup_selection_background+";}":"")+(a.mashup_hover_background?".widget-bootstrapcollection-container-"+f+":hover {background-color: "+a.mashup_hover_background+";}":"")+(a.mashup_active_background?".widget-bootstrapcollection-container-"+f+":active {background-color: "+
a.mashup_active_background+";}":"")+(l||a.mashup_folded_height?".widget-bootstrapcollection-container-"+f+" {transition: 0.3s;}":""))+"</style>").appendTo(b);a.mashup_accordion_group&&(g.addClass("widget-bootstrapcollection-container-accordion-group-"+a.mashup_accordion_group),g.attr("mashup_folded_height",a.mashup_folded_height),g.attr("extra_border",l));b={width:"100%",height:"100%"};l&&(b.width="calc(100% - "+l+"px)",b.height="calc(100% - "+l+"px)",b.margin=l/2+"px");$("<div class='widget-bootstrapcollection-item widget-bootstrapcollection-item-"+
f+"'></div>").css(b).appendTo(".widget-bootstrapcollection-container-"+f).click(function(){a.mashup_folded_height&&!a.mashup_folding_class&&t(a,g,l);if(a.mashup_selection_group){$(".widget-bootstrapcollection-container-selection-group-"+a.mashup_selection_group).attr("class",function(a,b){return b.replace(/widget-bootstrapcollection-container-[0-9]*_[0-9]*-selected/,"")});g.addClass("widget-bootstrapcollection-container-"+f+"-selected");var b=e.getProperty("selectedItems");b=TW.InfoTableUtilities.CloneInfoTable({dataShape:b.dataShape,
rows:b.rows.filter(function(b){return a.mashup_selection_group!==b.mashup_selection_group}).concat([a])});e.setProperty("selectedItems",b);p=p.filter(function(b){return a.mashup_selection_group!==d[b].mashup_selection_group}).concat([c]);e.updateSelection("data",p)}a.mashup_clickable&&(b=TW.InfoTableUtilities.CloneInfoTable({dataShape:k,rows:[a]}),e.setProperty("clickedItem",b),b=TW.InfoTableUtilities.CloneInfoTable({dataShape:a.mashup_data.dataShape,rows:a.mashup_data.rows}),e.setProperty("clickedDataItem",
b),e.jqElement.triggerHandler("ItemWasClicked"))}).mashup({mashupName:a.mashup_name,mashupParameters:a.mashup_data.rows[0],loaded:function(a,b){},loadFail:function(a){},gotSize:function(a,b){}});a.mashup_folded_height&&a.mashup_folding_class&&$(".widget-bootstrapcollection-item-"+f+" ."+a.mashup_folding_class).click(function(){t(a,g,l)})}else{a.height&&g.css({height:a.height+"px","overflow-y":"auto"});var m=[];b=d.filter(function(b,c){b.parent_uid===a.uid&&m.push(c);return b.parent_uid===a.uid});
for(var h=0;h<b.length;h++)r(b[h],m[h],d,".widget-bootstrapcollection-container-"+f,k,q);g.scroll(function(){var a=g.scrollTop();q&&console.log("BootstrapCollection - scroll - widget-bootstrapcollection-container-"+f+" - scrollTop = "+a);n[""+c]=a});a.container_scroll_to_selected&&(b=b.findIndex(function(a){return a.mashup_selected}),-1!==b&&(b=$(".widget-bootstrapcollection-container-"+f).children("div").eq(b).offset().top,g.scrollTop(b)));a.container_scroll_to_previous_position&&n[""+c]&&g.scrollTop(n[""+
c])}}function t(a,c,d){var b=c.height()===a.height+d?a.mashup_folded_height:a.height;$(".widget-bootstrapcollection-container-accordion-group-"+a.mashup_accordion_group).each(function(a,b){a=parseInt($(b).attr("mashup_folded_height"));var c=parseInt($(b).attr("extra_border"));a&&$(b).css("height",a+c+"px")});c.css("height",b+d+"px")}var e=this,d=(new Date).getTime()+"_"+Math.floor(1E3*Math.random()),p=[],n=[];this.runtimeProperties=function(){return{supportsAutoResize:!0,needsDataLoadingAndError:!1}};
this.renderHtml=function(){return'<div class="widget-content widget-bootstrapcollection bootstrapcollection_'+d+'">  <div class="bootstrapcollection_'+d+'_header col-sm-12"></div>  <div class="bootstrapcollection_'+d+'_collection col-sm-12"></div>  <div class="bootstrapcollection_'+d+'_footer col-sm-12"></div></div>'};this.afterRender=function(){var a=e.getProperty("debugMode");$(".bootstrapcollection_"+d).scroll(function(){var c=$(".bootstrapcollection_"+d).scrollTop();a&&console.log("BootstrapCollection - scroll - bootstrapcollection_"+
d+" - scrollTop = "+c);n["bootstrapcollection_"+d]=c});h("header","all");h("footer","all")};this.handleSelectionUpdate=function(a,c,d){};this.resize=function(a,c){};this.serviceInvoked=function(a){};this.updateProperty=function(a){switch(a.TargetProperty){case "debugMode":case "scrollToSelected":case "scrollToPreviousPosition":this.setProperty(a.TargetProperty,a.RawSinglePropertyValue);break;case "headerMashup":case "headerData":this.setProperty(a.TargetProperty,a.RawSinglePropertyValue);h("header",
"mashup");break;case "headerHeight":this.setProperty(a.TargetProperty,a.RawSinglePropertyValue);h("header","height");break;case "footerMashup":case "footerData":this.setProperty(a.TargetProperty,a.RawSinglePropertyValue);h("footer","mashup");break;case "footerHeight":this.setProperty(a.TargetProperty,a.RawSinglePropertyValue);h("footer","height");break;case "data":u(a.RawSinglePropertyValue)}};this.beforeDestroy=function(){}};